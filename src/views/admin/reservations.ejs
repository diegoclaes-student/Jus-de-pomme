<div class="card p-3 p-md-4 mb-4">
  <h2 class="h4 mb-3"><i class="bi bi-list-check me-1"></i>Réservations</h2>
  <form method="get" class="row g-3">
    <div class="col-md-4">
      <label class="form-label">Date</label>
      <input type="date" name="date" value="<%= query.date %>" class="form-control">
    </div>
    <div class="col-md-4">
      <label class="form-label">Lieu</label>
      <input type="text" name="lieu" placeholder="Filtrer par lieu" value="<%= query.lieu %>" class="form-control">
    </div>
    <div class="col-md-4 d-flex align-items-end">
      <button class="btn btn-primary"><i class="bi bi-search me-1"></i>Filtrer</button>
    </div>
  </form>
</div>

<div class="card p-0">
  <% if (reservations.length === 0) { %>
    <div class="alert alert-light border m-3">Aucune réservation trouvée.</div>
  <% } else { %>
    <div class="table-responsive">
      <table class="table table-hover align-middle m-0">
        <thead class="table-light">
          <tr>
            <th>Date/Heure</th>
            <th>Lieu</th>
            <th>Nom</th>
            <th>Téléphone</th>
            <th>Qté</th>
            <th>Commentaire</th>
            <th class="text-end">Actions</th>
          </tr>
        </thead>
        <tbody>
          <% reservations.forEach(r => { const d = new Date(r.start_at); const hm = String(d.getHours()).padStart(2,'0')+':'+String(d.getMinutes()).padStart(2,'0'); %>
            <tr>
              <td><%= r.date %> <span class="text-nowrap"><%= hm %></span></td>
              <td><%= r.location %></td>
              <td><%= r.first_name %> <%= r.last_name %></td>
              <td><%= r.phone %></td>
              <td><span class="badge text-bg-primary"><%= r.quantity %></span></td>
              <td><%= r.comment || "" %></td>
              <td class="text-end">
                <form method="post" action="/admin/reservations/delete" onsubmit="return confirm('Supprimer cette réservation ?')" class="d-inline">
                  <input type="hidden" name="token" value="<%= r.token %>">
                  <button class="btn btn-sm btn-outline-danger"><i class="bi bi-trash"></i></button>
                </form>
              </td>
            </tr>
          <% }) %>
        </tbody>
      </table>
    </div>
  <% } %>
</div>